<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>李克兢</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="李克兢">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="李克兢">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="李克兢">
  
    <link rel="alternate" href="/atom.xml" title="李克兢" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">李克兢</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-ES-1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/06/ES-1/" class="article-date">
  <time datetime="2018-08-06T07:32:12.000Z" itemprop="datePublished">2018-08-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/06/ES-1/">ES-1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>OpenGL ES的主要作用是将3D场景绘制到2D屏幕上，在图形学中，这一过程通过一系列的渲染管线完成。</p>
<p>API就是用来向各个阶段提供一些数据和状态指令，以使渲染管线能够按照要求正确地将物体绘制在屏幕上的。</p>
<p>左边的客户端程序通过调用OpenGL ES接口，将顶点、着色器程序，纹理，以及其他GL状态参数传入右边的GL服务端，然后在客户端调用绘制命令（如DrawArray），GL便会对输入的图元逐一执行渲染管线的每个阶段，然后将每个像素的颜色值写入帧缓冲中，最后，视窗系统就可以将帧缓冲中的颜色值显示在屏幕上了。</p>
<p>顶点着色器和片段着色器是可编程的过程</p>
<h2 id="顶点数组"><a href="#顶点数组" class="headerlink" title="顶点数组"></a>顶点数组</h2><p>在传入OpenGL ES之前，应用程序应该将3D模型转换成一组图元的集合。每个图元都是一个点、线段或者三角形。每个图元由一个或者多个顶点组成，每个顶点定义一个点，一条边的一端或者三角形的一个角。每个顶点关联一些数据，这些数据包括顶点坐标、颜色法线向量，纹理坐标</p>
<p>通过顶点缓冲对象(vbo)绑定顶点数组,</p>
<h2 id="顶点着色器"><a href="#顶点着色器" class="headerlink" title="顶点着色器"></a>顶点着色器</h2><p>顶点着色器可以使用顶点数据来计算该顶点的坐标、颜色、光照、纹理坐标等。顶点坐标最重要的任务是执行顶点坐标变换，将本地坐标转换为裁剪坐标系的坐标值。顶点着色器用于输出顶点在裁剪坐标系中的坐标的变量为gl_Position。</p>
<p>另一个功能是向后面的片段着色器提供一组Varing变量</p>
<h2 id="图元装配"><a href="#图元装配" class="headerlink" title="图元装配"></a>图元装配</h2><h2 id="光栅化"><a href="#光栅化" class="headerlink" title="光栅化"></a>光栅化</h2><p>对图元中的片段进行采样，以决定哪些片段位于图元之内。在计算出每个片段的坐标值之后，片段着色器就能使用这个坐标值对该片段进行着色了，这个片段为最终屏幕上的一个像素点</p>
<h2 id="片段着色器"><a href="#片段着色器" class="headerlink" title="片段着色器"></a>片段着色器</h2><p>主要作用是计算每一个片段的颜色值</p>
<h2 id="片段测试"><a href="#片段测试" class="headerlink" title="片段测试"></a>片段测试</h2><p>像素所有权测试，裁剪测试，模板测试，深度测试，混合，抖动</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/06/ES-1/" data-id="cjkj0cqoc00038gv0hh3w200o" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Cocos2d-x精灵" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/31/Cocos2d-x精灵/" class="article-date">
  <time datetime="2018-07-31T09:22:39.000Z" itemprop="datePublished">2018-07-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/31/Cocos2d-x精灵/">Cocos2d-x精灵</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在Cocos2d-x中，精灵用Sprite类表示，它将一张纹理的一部分或者全部矩形区域绘制在屏幕上。我们可以使用精灵表来减少OpenGL ES绘制的次数</p>
<p>Sprite实现了TextureProtocol接口通过指定一张纹理及该纹理上的一个区域，就可以创建一个Sprite对象。</p>
<p>我们可以通过setTexture方法来动态修改Sprite关联的纹理，从而实现精灵动画。也可以使用SpriteFrame来高效地播放精灵动画。setTexture方法对新的texture执行retain操作，增加其引用计数</p>
<p>所有对Sprite绘制属性的修改（混合模式除外）最终都表现为对一个结构体类型变量quad的修改。</p>
<p>它用来记录一个矩形图元的4个顶点的顶点属性。由于OpenGL ES不支持多边形图元，实际是两个三角形</p>
<p>可以通过颜色混合和颜色叠加来影响OpenGL ES的绘制结果</p>
<p>颜色混合用来指定当前Sprite与颜色缓冲区中相同位置颜色值的混合方式。</p>
<h1 id="精灵表"><a href="#精灵表" class="headerlink" title="精灵表"></a>精灵表</h1><p>利用精灵表，我们可以对同一次绘制指定更多的顶点来减少绘制次数</p>
<p>SpriteFrameCache加载精灵表，缓存每一个精灵的信息。SpriteFrameCache通过解析配置文件将精灵表中的每个精灵存储为一个SpriteFrame对象，可以通过SpriteFrame创建一个Sprite</p>
<p>并不提供移除对应于Texture2D对象的功能。因为一个Texture2D对象可能被其他非SpriteFrame对象引用，所以，如果我们确定一个精灵表不再被使用，还应该移除对应的Texture2D对象</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/31/Cocos2d-x精灵/" data-id="cjkj0cqo300008gv0xd8p4omi" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cocos2d-x-OpenGL/">Cocos2d-x OpenGL</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Cocos2d-x纹理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/30/Cocos2d-x纹理/" class="article-date">
  <time datetime="2018-07-30T01:32:01.000Z" itemprop="datePublished">2018-07-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/30/Cocos2d-x纹理/">Cocos2d-x纹理</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>3D图形渲染最重要的工作之一是将纹理应用到物体表面，这个过程主要发生在片段着色器工作的阶段，使用光栅化阶段插值计算得出的纹理坐标从纹理中采样，然后对片段进行着色，可以处理丰富的特效，如光照、阴影等。</p>
<p>对纹理进行各个层面的优化是一项重要的工作，我们需要知道关于纹理的一切内容，才能知道应该从哪方面以及怎样对其进行优化。</p>
<p>在Cocos2d-x中主要通过Texture2D类来创造和管理OpenGL ES 纹理。</p>
<h1 id="光栅化"><a href="#光栅化" class="headerlink" title="光栅化"></a>光栅化</h1><p>光栅化阶段用于将投影到2D屏幕上的图元转换为帧缓冲中整数坐标位置上的片段，每个片段都会包含颜色、深度和模板值。每个片段的颜色值由片段着色器决定，片段着色器会使用光栅化生成的一些易变变量（Varying）</p>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>首先确定视窗上哪些整数的片段需要被图元覆盖</p>
<p>对图元进行插值运算，得出每个片段的颜色和深度，这些数据送入片段操作进行处理，最后的结果将用于更新帧缓冲上该位置的信息。</p>
<h1 id="多重采样"><a href="#多重采样" class="headerlink" title="多重采样"></a>多重采样</h1><h2 id="反锯齿"><a href="#反锯齿" class="headerlink" title="反锯齿"></a>反锯齿</h2><p>也称抗锯齿和边缘柔化，是一种用于消除显示器输出的画面中图像边缘出现锯齿的技术。锯齿通常是因为高分辨率信号以低分辨率显示或者无法准确计算出3D图形左边是导致的图形混叠而产生的。</p>
<p>使用多重采样技术解决这个问题，帧缓冲上的每个像素基于附近多个位置的采样共同决定的一个颜色值，使用而外的多重采样缓冲区来存储这些额外采样点的颜色、深度和模板值</p>
<p>默认cocos不开启，手动修改CCEAGLView初始化的multiSampling参数来开启</p>
<p>在开启多重采样之后，缓冲区的像素信息不再被存储到帧缓冲中，而是被存储到一个特殊的多重采样的缓冲区中,注意，多重采样只是针对多边形的边缘进行抗锯齿处理，对应用程序性能的影响相对较小，</p>
<h2 id="纹理坐标"><a href="#纹理坐标" class="headerlink" title="纹理坐标"></a>纹理坐标</h2><p>纹理坐标以纹理的左下角为左边原点，两种度量形式：一个顶点在纹理中的纹理坐标通常用(u,v)表示，u和v的最大值分别是纹理的宽度和高度，它的值通常由客户端应用程序提供，在片段着色器中使用的片段纹理坐标通常用(s,t)表示，其取值范围为(0.0,0.0)~(1.0,1.0)。这一规化过程是在光栅化阶段完成的</p>
<p>##像素矩形</p>
<p>它表示一个矩形区域的二维像素数组，它可以用来表示一个矩形区域的颜色、深度或者模板值</p>
<p>存储颜色值的像素矩形可以通过TexImage2D及其相关命令定义，并将数据由客户端内存中传输至GL服务端内存中，或者通过ReadPixels及相关命令将数据从帧缓冲区中读取到客户端内存中，其中将客户端的颜色数据传输到GL服务端的过程称为解包（Unpack）,而与之相反，将服务端像素矩形中的像素数据读取到客户端的过程称为打包（Pack）。</p>
<p>通过TexImage2D及相关命令定义的像素矩形称为纹理。纹理由纹理像素组成，简称纹素。一个2D纹理由一个二维的纹素数组组成，纹理的宽度表示列数，高度表示数组的行数，数组中的第一个元素表示纹理左下角的像素点</p>
<h3 id="纹理数据的传输"><a href="#纹理数据的传输" class="headerlink" title="纹理数据的传输"></a>纹理数据的传输</h3><p>##客户端图像格式</p>
<p>在将纹理传输到GL服务端以供片段着色器等使用时，我们必须指明纹理在服务端以怎样的方式存储，这需要通过TexImage2D等命令来设置。</p>
<h2 id="纹理对象和加载纹理"><a href="#纹理对象和加载纹理" class="headerlink" title="纹理对象和加载纹理"></a>纹理对象和加载纹理</h2><p>在绘图管线中，纹理主要在片段着色器中被使用。每一次绘制命令（glDrawArray或者glDrawElements）执行时，需要告诉OpenGL ES当前管线中使用的一个或者多个纹理，这涉及管理纹理对象，绑定当前纹理对象，将纹理数据加载到OpenGL ES内存中等命令操作。</p>
<p>一个纹理对象是一个容器，它持有该纹理被使用时需要用到的所有数据，包括图像像素数据、过滤模式、拓展模式等。在OpenGL ES中，用一个无符号整数表示该纹理对象的名称，纹理对象用glGenTextures命令创建</p>
<p>创建之后，必须绑定才能操作，在这里OpenGL ES通过设定当前纹理对象对其进行操作，设定当前纹理对象之后，后续（直到纹理对象被删除或者下一个纹理绑定命令被执行之前）的操作将作用在该纹理对象上。glBindTexture命令</p>
<p>glTexImage2D命令加载纹理。一旦该命令执行，会立即将图像像素数据从客户端传输到服务端内存中，后续对客户端数据的修改不会影响OpenGL ES中绑定的纹理数据。因此，客户端在将数据加载到OpenGL ES内存中之后，应该立即删除客户端中的缓存对象。</p>
<h1 id="纹理缓存管理"><a href="#纹理缓存管理" class="headerlink" title="纹理缓存管理"></a>纹理缓存管理</h1><p>我们可以通过选择适当的图片格式，或者使用压缩纹理来减少纹理对内存的占用。</p>
<p>纹理缓存系统的主要目标是使只有当前场景需要显示的纹理驻留在内存中，开发者的职责则是要定义哪些是当前场景需要使用的资源。另外，在纹理使用期间，它应该只被创建一次，并且避免动态加载纹理，我们始终应该在进入一个场景时预加载相关纹理，这是一个耗时的操作，而且是在主线程中完成的。</p>
<h3 id="纹理的生命周期"><a href="#纹理的生命周期" class="headerlink" title="纹理的生命周期"></a>纹理的生命周期</h3><p>在Cocos2d-x中，一个Texture2D实例对应OpenGL ES中的一张纹理，initWithMipmaps ()方法。</p>
<p>每个Texture2D实例在未被销毁之前，GPU会一直缓存该纹理对象。如果销毁Texture2D，则会删除对应的纹理对象。</p>
<p>TextureCache提供了对Texture2D对象的更好的管理方式</p>
<p>##TextureCache</p>
<p>TextureCache最终要的功能是为每个纹理的Texture2D对象创建一个索引键，索引键主要有两类：当使用文件名创建纹理的时候，文件所在全路径成为索引键。也可以手动给通过Image创建的纹理分配一个指定的索引键</p>
<p>使用addImageAsync()方法异步加载纹理，通常用在进入一个新场景里面，使用一个加载页面</p>
<p>TextureCache管理下的纹理的生命周期</p>
<p>没有TextureCache的情况下，直接通过string、image或者data创建一个Texture2D对象，这时该对象的引用计数为1.用该对象构建一个Sprite元素，Sprite元素首先对它进行retain以确保纹理对象不被删除，并在被移出场景的时候release，此时Texture2D的生命周期取决于我们是否还要继续使用它。但是无论如何，我们都需要记住每个Texture2D对象对应哪一张图片，而且要让这些独立的Texture2D对象在其他的类中被使用要费一般周折</p>
<p>TextureCache中的每个Texture2D对象的引用计数是1，如果有元素正在使用该纹理，则引用计数为正在使用的元素个数加1.1表示空闲状态，使用removeUnusedTextures()方法来移除空闲的纹理以释放资源。</p>
<p>如果确认某个纹理不再使用，removeTexture()，这时Texture2D对象将执行一次release</p>
<h2 id="场景过度中的资源管理"><a href="#场景过度中的资源管理" class="headerlink" title="场景过度中的资源管理"></a>场景过度中的资源管理</h2><h4 id="基于引用计数的资源管理"><a href="#基于引用计数的资源管理" class="headerlink" title="基于引用计数的资源管理"></a>基于引用计数的资源管理</h4><p>计数指的是应用程序在逻辑上使用哪些资源</p>
<h4 id="更好的场景过度资源管理"><a href="#更好的场景过度资源管理" class="headerlink" title="更好的场景过度资源管理"></a>更好的场景过度资源管理</h4><p>Cocos2d-x没有提供场景或者关卡层面上的资源管理方案。</p>
<p>ResourceManager负责逻辑上的资源引用计数管理。记录每个资源在场景中的引用情况。应用程序只需要和ResourceManager进行交互。</p>
<p>ResourceManager主要作用是解决场景之间的资源共享</p>
<h2 id="纹理所占内存的计算"><a href="#纹理所占内存的计算" class="headerlink" title="纹理所占内存的计算"></a>纹理所占内存的计算</h2><h2 id="使用纹理的最佳实践"><a href="#使用纹理的最佳实践" class="headerlink" title="使用纹理的最佳实践"></a>使用纹理的最佳实践</h2><h3 id="硬件层面"><a href="#硬件层面" class="headerlink" title="硬件层面"></a>硬件层面</h3><p>一般通过引擎完成</p>
<h3 id="程序层面"><a href="#程序层面" class="headerlink" title="程序层面"></a>程序层面</h3><p>首先，始终提前加载资源，避免在游戏运行中动态加载资源</p>
<p>其次，减少纹理的内存占用，实时释放那些不再被使用的纹理资源，这要求开发者必须清楚地定义每个资源的生命周期</p>
<p>再次，我们应该将一些小的碎片纹理合成一张大的纹理</p>
<p>第四，使用多级纹理减少内存的占用。对于一些低分辨率的设备，仅上传对应级别的多级纹理</p>
<p>第五，使员工多重纹理，对于一些复杂的UI元素，开发者通常会选择绘制多次，每次单独使用一个纹理，这使得绘制次数增加，占用更多的时间（多次绘制串行执行），以及重复的顶点数据的传输和读取。使用多级纹理一次性将所有问哦李传入进一个渲染管线</p>
<p>最后，使用Alpha预乘来减少透明纹理在场景混合时的计算量</p>
<h3 id="资源层面"><a href="#资源层面" class="headerlink" title="资源层面"></a>资源层面</h3><p>选择适当的资源格式</p>
<p>设置正确的defaultAlphaPixelFormat将不同格式的纹理上传GL内存</p>
<p>使用压缩纹理</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/30/Cocos2d-x纹理/" data-id="cjkj0cqpb000s8gv055vj5jzb" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cocos2d-x-OpenGL/">Cocos2d-x OpenGL</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Cocos2d-x的优化" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/28/Cocos2d-x的优化/" class="article-date">
  <time datetime="2018-07-28T02:16:15.000Z" itemprop="datePublished">2018-07-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/28/Cocos2d-x的优化/">Cocos2d-x的优化</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Cocos2d-JS"><a href="#Cocos2d-JS" class="headerlink" title="Cocos2d-JS"></a>Cocos2d-JS</h1><h2 id="对象缓存池"><a href="#对象缓存池" class="headerlink" title="对象缓存池"></a>对象缓存池</h2><p>###简介</p>
<p>对于频繁创建和销毁的对象（如子弹、敌人）使用cc.pool对象。</p>
<p>注：使用cc.pool之前需要在project.json的modules数组中添加ccpool项</p>
<p>###使用</p>
<ol>
<li>让类支持cc.pool管理：类必须实现reuse和unuse方法。因为对象的缓存通过cc.pool.putInPool(object)函数实现，该函数会调用该对象的unuse方法。一般情况下，在unuse方法中完成对象被放入缓冲池前的操作。</li>
<li>预备工作：首次创建好一定量的对象，并把他们放入缓冲池。</li>
</ol>
<p>在游戏场景结束，切换场景的时候，调用cc.pool.drainAllPools()清空对象缓存池。</p>
<h3 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> SupportPoolHero = cc.Sprite.extend(&#123;</span><br><span class="line">    _hp : <span class="number">0</span>,    <span class="comment">// 血量</span></span><br><span class="line">    _sp : <span class="number">0</span>,    <span class="comment">// 愤怒</span></span><br><span class="line">    _mp : <span class="number">0</span>,    <span class="comment">// 魔法</span></span><br><span class="line">    ctor: <span class="function"><span class="keyword">function</span> (<span class="params">hp, mp, sp</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>._super(res.sh_node_64_png);</span><br><span class="line">        <span class="keyword">this</span>.initData(hp, mp, sp);</span><br><span class="line">    &#125;,</span><br><span class="line">    initData: <span class="function"><span class="keyword">function</span> (<span class="params">hp, mp, sp</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>._hp, <span class="keyword">this</span>._mp, <span class="keyword">this</span>._sp = hp, mp, sp;</span><br><span class="line">    &#125;,</span><br><span class="line">    unuse: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>._hp = <span class="keyword">this</span>._mp = <span class="keyword">this</span>._sp = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.retain(); <span class="comment">// 使其引用计数+1，防止被内存回收</span></span><br><span class="line">        <span class="keyword">this</span>.removeFromParent();</span><br><span class="line">    &#125;,</span><br><span class="line">    reuse: <span class="function"><span class="keyword">function</span> (<span class="params">hp, mp, sp</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.initData(hp, mp, sp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">SupportPoolHero.create = <span class="function"><span class="keyword">function</span> (<span class="params">hp, mp, sp</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SupportPoolHero(hp, mp, sp)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">SupportPoolHero.reCreate = <span class="function"><span class="keyword">function</span> (<span class="params">hp, mp, sp</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 判断[对象缓冲池中是否有可用对象]</span></span><br><span class="line">    <span class="keyword">if</span> (cc.pool.hasObject(SupportPoolHero))&#123;</span><br><span class="line">        <span class="comment">// 从对象缓冲池中获取对象</span></span><br><span class="line">        <span class="keyword">return</span> cc.pool.getFromPool(SupportPoolHero, hp, mp, sp);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// 创建一个新的对象</span></span><br><span class="line">        <span class="keyword">return</span>  SupportPoolHero.create(hp, mp, sp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> CCPoolLayer = cc.Layer.extend(&#123;</span><br><span class="line">    createCount         : <span class="number">3000</span>,</span><br><span class="line">    createHeroList      : [],</span><br><span class="line">    reCreateHeroList    : [],</span><br><span class="line">    timeList            : &#123;&#125;,</span><br><span class="line">    ctor : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>._super();</span><br><span class="line">        <span class="comment">// 加载[菜单]_2种方式创建对象</span></span><br><span class="line">        <span class="keyword">this</span>.loadMenu();</span><br><span class="line">        <span class="comment">// 加载[标签]_加载时间反馈</span></span><br><span class="line">        <span class="keyword">this</span>.loadLabelInfo();</span><br><span class="line">        <span class="comment">// 为pool准备对象</span></span><br><span class="line">        <span class="keyword">this</span>.prepareHeroForPool();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 加载[菜单]_2种方式创建对象</span></span><br><span class="line">    loadMenu : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// 创建[标签]_按钮文本说明</span></span><br><span class="line">        <span class="keyword">var</span> labCreate = <span class="keyword">new</span> cc.LabelTTF(<span class="string">"直接创建"</span> + <span class="keyword">this</span>.createCount + <span class="string">"个精灵！"</span>, <span class="string">"Arial"</span>, <span class="number">24</span>);</span><br><span class="line">        <span class="keyword">var</span> labReCreate = <span class="keyword">new</span> cc.LabelTTF(<span class="string">"使用pool创建"</span> + <span class="keyword">this</span>.createCount + <span class="string">"个精灵！"</span>, <span class="string">"Arial"</span>, <span class="number">24</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建[菜单项]</span></span><br><span class="line">        <span class="keyword">var</span> itemCreate = <span class="keyword">new</span> cc.MenuItemLabel(labCreate, <span class="keyword">this</span>.addSpriteByCreate, <span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">var</span> itemReCreate = <span class="keyword">new</span> cc.MenuItemLabel(labReCreate, <span class="keyword">this</span>.addHeorByPool, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建[菜单]</span></span><br><span class="line">        <span class="keyword">var</span> menu = <span class="keyword">new</span> cc.Menu(itemCreate, itemReCreate);</span><br><span class="line">        menu.alignItemsHorizontallyWithPadding(<span class="number">150</span>);</span><br><span class="line">        <span class="keyword">this</span>.addChild(menu);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 加载[标签]_加载时间反馈</span></span><br><span class="line">    loadLabelInfo : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// 创建[标签]</span></span><br><span class="line">        <span class="keyword">this</span>.labDirect = <span class="keyword">new</span> cc.LabelTTF(<span class="string">"直接创建耗费:"</span>, <span class="string">"Arial"</span>, <span class="number">18</span>);</span><br><span class="line">        <span class="keyword">this</span>.labDirect.setPosition(cc.pAdd(cc.visibleRect.center, cc.p(<span class="number">-230</span>, <span class="number">-65</span>)));</span><br><span class="line">        <span class="keyword">this</span>.labDirect.anchorY = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.addChild(<span class="keyword">this</span>.labDirect);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建[标签]</span></span><br><span class="line">        <span class="keyword">this</span>.poolLabel = <span class="keyword">new</span> cc.LabelTTF(<span class="string">"使用pool创建耗费:"</span>, <span class="string">"Arial"</span>, <span class="number">18</span>);</span><br><span class="line">        <span class="keyword">this</span>.poolLabel.setPosition(cc.pAdd(cc.visibleRect.center, cc.p(<span class="number">200</span>, <span class="number">-65</span>)));</span><br><span class="line">        <span class="keyword">this</span>.poolLabel.anchorY = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.addChild(<span class="keyword">this</span>.poolLabel);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 准备工作[创建好对象，并把他们放入对象缓冲池]</span></span><br><span class="line">    prepareHeroForPool : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.createCount; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> node = SupportPoolHero.create(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">this</span>.addChild(node);</span><br><span class="line">            cc.pool.putInPool(node);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 添加[精灵]_直接生成</span></span><br><span class="line">    addSpriteByCreate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.createHeroList = [];</span><br><span class="line">        <span class="keyword">this</span>.timeStart(<span class="string">"directly"</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.createCount; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> node = SupportPoolHero.create(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">            <span class="keyword">this</span>.createHeroList.push(node);</span><br><span class="line">            <span class="keyword">this</span>.addChild(node);</span><br><span class="line">            node.setPosition(<span class="number">10</span> * i, cc.visibleRect.height * <span class="number">0.8</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.setDirectLabel(<span class="keyword">this</span>.timeEnd(<span class="string">"directly"</span>));</span><br><span class="line">        <span class="keyword">this</span>.scheduleOnce(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.createHeroList.length; i++) &#123;</span><br><span class="line">                <span class="keyword">this</span>.createHeroList[i].removeFromParent(<span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.createHeroList = [];</span><br><span class="line">        &#125;, <span class="number">0.5</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 从pool中获取英雄</span></span><br><span class="line">    addHeorByPool: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.reCreateHeroList = [];</span><br><span class="line">        <span class="keyword">this</span>.timeStart(<span class="string">"use Pool"</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.createCount; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> node = SupportPoolHero.reCreate(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>);</span><br><span class="line">            <span class="keyword">this</span>.reCreateHeroList.push(node);</span><br><span class="line">            <span class="keyword">this</span>.addChild(node);</span><br><span class="line">            node.setPosition(<span class="number">10</span> * i, cc.visibleRect.height * <span class="number">0.8</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.setPoolLabel(<span class="keyword">this</span>.timeEnd(<span class="string">"use Pool"</span>));</span><br><span class="line">        <span class="keyword">this</span>.scheduleOnce(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.reCreateHeroList.length; i++) &#123;</span><br><span class="line">                cc.pool.putInPool(<span class="keyword">this</span>.reCreateHeroList[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.reCreateHeroList = [];</span><br><span class="line">        &#125;, <span class="number">0.5</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    timeStart: <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.timeList[name] = &#123;<span class="attr">startTime</span>: <span class="built_in">Date</span>.now(), <span class="attr">EndTime</span>: <span class="number">0</span>, <span class="attr">DeltaTime</span>: <span class="number">0</span>&#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    timeEnd: <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> obj = <span class="keyword">this</span>.timeList[name];</span><br><span class="line">        obj.EndTime = <span class="built_in">Date</span>.now();</span><br><span class="line">        obj.DeltaTime = obj.EndTime - obj.startTime;</span><br><span class="line">        <span class="keyword">return</span> obj.DeltaTime;</span><br><span class="line">    &#125;,</span><br><span class="line">    setDirectLabel: <span class="function"><span class="keyword">function</span> (<span class="params">time</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (time == <span class="number">0</span>) &#123;</span><br><span class="line">            time = <span class="string">"&lt;1"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.labDirect.setString(<span class="string">"直接创建耗费:"</span> + time + <span class="string">"ms"</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    setPoolLabel: <span class="function"><span class="keyword">function</span> (<span class="params">time</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (time == <span class="number">0</span>) &#123;</span><br><span class="line">            time = <span class="string">"&lt;1"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.poolLabel.setString(<span class="string">"使用pool创建耗费::"</span> + time + <span class="string">"ms"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="批量渲染"><a href="#批量渲染" class="headerlink" title="批量渲染"></a>批量渲染</h2><p>一般情况下，将图片按照模块分类，用TexturePacker合成大图，这样合理的管理了图片资源，也更贴近引擎的渲染优化。</p>
<h2 id="cocos2d-x的自动批渲染"><a href="#cocos2d-x的自动批渲染" class="headerlink" title="cocos2d-x的自动批渲染"></a>cocos2d-x的自动批渲染</h2><p>见cocos2d-x绘制系统的博文，自动批绘制需要相关的绘制命令在执行顺序上相邻</p>
<p>##SpriteBatchNode技术</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>批处理绘制精灵，创建一张纹理，然后将多个精灵添加到此纹理中，绘制时直接绘制该纹理，无需单独绘制子节点。因为在Web上，优先采用WebGL渲染，若不支持WebGL，则采用Canvas绘制。只在WebGL情况下有效</p>
<p>渲染每个精灵的过程都会经历“打开-绘制-关闭”的流程，使用SpriteBatchNode的时候只用打开关闭一次。</p>
<p>###源码</p>
<p>需要再看</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>将纹理加载到内存。</p>
<p>创建SpriteBatchNode。</p>
<p>创建精灵并将其添加到SpriteBatchNode。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> BatchNodeLayer = cc.Layer.extend(&#123;</span><br><span class="line">    batchNode : <span class="literal">null</span>,</span><br><span class="line">    ctor : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>._super();</span><br><span class="line">        <span class="comment">// 第一步：加载[资源]</span></span><br><span class="line">        <span class="keyword">this</span>.loadResource();</span><br><span class="line">        <span class="comment">// 第二步：加载[BatchNode]</span></span><br><span class="line">        <span class="keyword">this</span>.loadBatchNode();</span><br><span class="line">        <span class="comment">// 第三步：加载[8000个精灵]</span></span><br><span class="line">        <span class="keyword">this</span>.loadSomePrince();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 加载[资源]</span></span><br><span class="line">    loadResource : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        cc.textureCache.addImage(res.u13_prince_png);</span><br><span class="line">        cc.spriteFrameCache.addSpriteFrames(res.u13_prince_plist);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 加载[SpriteBatchNode]</span></span><br><span class="line">    loadBatchNode : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.batchNode = <span class="keyword">new</span> cc.SpriteBatchNode(res.u13_prince_png);</span><br><span class="line">        <span class="keyword">this</span>.addChild(<span class="keyword">this</span>.batchNode);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 加载[8000个精灵]_并将其添加到this.batchNode中</span></span><br><span class="line">    loadSomePrince : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> node = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">var</span> pos = cc.p(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">8000</span>; i++) &#123;    <span class="comment">// 创建8000个精灵</span></span><br><span class="line">            node = <span class="keyword">new</span> cc.Sprite(<span class="string">"#prince_stand_1.png"</span>);</span><br><span class="line">            <span class="comment">//this.batchNode.addChild(node);  // 添加到batchNode对象中</span></span><br><span class="line">            <span class="keyword">this</span>.addChild(node);</span><br><span class="line"></span><br><span class="line">            pos.x = <span class="built_in">Math</span>.random() * cc.visibleRect.width;</span><br><span class="line">            pos.y = <span class="built_in">Math</span>.random() * cc.visibleRect.height;</span><br><span class="line">            node.setPosition(pos);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="烘焙层"><a href="#烘焙层" class="headerlink" title="烘焙层"></a>烘焙层</h2><p>对于一些很少发生例如添加删除运行动作的变动的层，我们可以使用图层预烘焙技术。</p>
<p>cc.Layer的bake函数，一个调用了bake函数的层会将其自身以及所有子节点烘焙到一张画布（canvas）上，只要自身以及所有子节点不发生例如添加或者删除子节点以及运行动作等变动行为，那么在下一帧绘制时，引擎会将预烘焙到画布上的内容直接绘制出来。使得原本需要调用多次绘制的层，现在只需要绘制一次。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> BakeLayer = cc.Layer.extend(&#123;</span><br><span class="line">    lastPrince : <span class="literal">null</span>,</span><br><span class="line">    ctor : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>._super();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.loadMenu();</span><br><span class="line">        <span class="keyword">this</span>.loadSomePrince();</span><br><span class="line">    &#125;,</span><br><span class="line">    loadMenu : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> itemBake = <span class="keyword">new</span> cc.MenuItemFont(<span class="string">"bake"</span>, <span class="keyword">this</span>.onBake, <span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">var</span> itemUnbake = <span class="keyword">new</span> cc.MenuItemFont(<span class="string">"unbake"</span>, <span class="keyword">this</span>.onUnbake, <span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">var</span> itemRunAction = <span class="keyword">new</span> cc.MenuItemFont(<span class="string">"run action"</span>, <span class="keyword">this</span>.onRunAction, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> menu = <span class="keyword">new</span> cc.Menu(itemBake, itemUnbake, itemRunAction);</span><br><span class="line">        <span class="keyword">this</span>.addChild(menu, <span class="number">1</span>);</span><br><span class="line">        menu.alignItemsVertically();</span><br><span class="line">        menu.x = cc.winSize.width - <span class="number">100</span>;</span><br><span class="line">        menu.y = cc.winSize.height - <span class="number">80</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    loadSomePrince : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> node = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">var</span> pos = cc.p(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">8000</span>; i++) &#123;    <span class="comment">// 创建8000个精灵</span></span><br><span class="line">            node = <span class="keyword">new</span> cc.Sprite(<span class="string">"#prince_stand_1.png"</span>);</span><br><span class="line">            <span class="keyword">this</span>.addChild(node);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 属性配置</span></span><br><span class="line">            pos.x = <span class="built_in">Math</span>.random() * cc.winSize.width + <span class="number">150</span>;</span><br><span class="line">            pos.y = <span class="built_in">Math</span>.random() * cc.winSize.height * <span class="number">0.65</span>;</span><br><span class="line">            node.setPosition(pos);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>.lastPrince = node;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    onBake : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.bake();</span><br><span class="line">    &#125;,</span><br><span class="line">    onUnbake : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.unbake();</span><br><span class="line">    &#125;,</span><br><span class="line">    onRunAction : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> move = cc.moveBy(<span class="number">2</span>, cc.p(<span class="number">0</span>, <span class="number">-200</span>));</span><br><span class="line">        <span class="comment">//this.runAction(move);</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.lastPrince.runAction(move);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>仅在Canvas渲染模式下有效</p>
<h2 id="图片资源优化"><a href="#图片资源优化" class="headerlink" title="图片资源优化"></a>图片资源优化</h2><p>在OpenGL/WebGL中，纹理的宽度和高度都必须是2的n次幂，超出则向上取最接近的</p>
<p>使用TP打包</p>
<p>生成.plist配置文件和一个.png。使用代码</p>
<p><code>cc.textureCache.addImage(res.xx_png);</code></p>
<p><code>cc.spriteFrameCache.addSpriteFrames(res.xx_plist);</code></p>
<p>使用TinyPNG压缩</p>
<h2 id="精灵的创建方式"><a href="#精灵的创建方式" class="headerlink" title="精灵的创建方式"></a>精灵的创建方式</h2><p>每个精灵一般都关联着一张纹理贴图，Texture2D对象</p>
<p>1.通过图片资源创建，直接传入图片的路径（不推荐）</p>
<p>2.通过纹理创建</p>
<p><code>var textrue = cc.textureCache.addImage(res.xx_png);</code></p>
<p><code>var node = new Sprite(textrue);</code></p>
<p>3.精灵表单，先将plist文件和图片加载到内存中，然后再创建</p>
<p><code>cc.spriteFrameCache.addSpriteFrames(res.xx_plist，res.xx_png);</code></p>
<p><code>var node = new Sprite(”#prince。png“);</code></p>
<p>4.创建带颜色的精灵</p>
<p>如果要纯色块的，setColor和setTextureRect，而不是setContentSize</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/28/Cocos2d-x的优化/" data-id="cjkj0cqpa000r8gv0gucmpcvl" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cocos2d-x-优化/">Cocos2d-x 优化</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-网络-TCP" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/27/网络-TCP/" class="article-date">
  <time datetime="2018-07-27T03:20:11.000Z" itemprop="datePublished">2018-07-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/27/网络-TCP/">网络-TCP</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="TCP的包头"><a href="#TCP的包头" class="headerlink" title="TCP的包头"></a>TCP的包头</h2><p>包的序号：解决乱序问题</p>
<p>确认序号：</p>
<p>状态位：</p>
<p>窗口大小：通信双方各声明一个窗口，标识当前自己能够处理的能力</p>
<h1 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h1><p>三次握手除了双方建立连接外，主要还是为了沟通TCP包的序号问题</p>
<h1 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a>四次挥手</h1><h1 id="为何靠谱"><a href="#为何靠谱" class="headerlink" title="为何靠谱"></a>为何靠谱</h1><p>客户端没发送一个包，服务器端都有个回复，如果服务端超过一定时间没有回复，客户端就会重新发送这个包，，知道有回复</p>
<p>累计确认，累计应答</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/27/网络-TCP/" data-id="cjkj0cqpk00198gv04jovg2e0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网络/">网络</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-网络-UDP" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/27/网络-UDP/" class="article-date">
  <time datetime="2018-07-27T02:55:41.000Z" itemprop="datePublished">2018-07-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/27/网络-UDP/">网络-UDP</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="TCP和UDP的区别"><a href="#TCP和UDP的区别" class="headerlink" title="TCP和UDP的区别"></a>TCP和UDP的区别</h1><p>TCP是面向连接的，UDP是面向无连接的</p>
<p>所谓的建立连接，是为了在客户端和服务端维护连接，而建立一定的数据结构来维护双方交互的状态。用这样的数据结构来保证所谓的面向连接的特性。</p>
<p>eg:TCP提供可靠交付，通过TCP传输的数据，无差错，不丢失，不重复，按顺序到达。而UDP不保证不丢失，不保证按顺序到达。</p>
<p>TCP是面向字节流的，而UDP继承了IP的特性，基于数据报的，一个一个的发，一个一个的收。</p>
<p>TCP可以有拥塞控制<a href="https://mp.weixin.qq.com/s/j0WeTRgJMohIYr-SraMyBw，UDP没有，应用让发就发。" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/j0WeTRgJMohIYr-SraMyBw，UDP没有，应用让发就发。</a></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>TCP是一个有状态服务（有脑子的服务），它记着发送了没有，接收到没有，发送到哪个了，应该接收哪个了</p>
<h1 id="UDP的包头"><a href="#UDP的包头" class="headerlink" title="UDP的包头"></a>UDP的包头</h1><p>很简单，只有端口号</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/27/网络-UDP/" data-id="cjkj0cqpl001b8gv0z0b794f5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网络/">网络</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Matter-js学习-1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/24/Matter-js学习-1/" class="article-date">
  <time datetime="2018-07-24T05:52:23.000Z" itemprop="datePublished">2018-07-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/24/Matter-js学习-1/">Matter.js学习-1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><p><a href="http://brm.io/matter-js/docs/" target="_blank" rel="noopener">http://brm.io/matter-js/docs/</a></p>
<h1 id="英文"><a href="#英文" class="headerlink" title="英文"></a>英文</h1><p>terrific：极好的</p>
<p>cube：立方体</p>
<h1 id="Cautions"><a href="#Cautions" class="headerlink" title="Cautions"></a>Cautions</h1><p>忘记<code>float</code>类型和<code>int</code>类型不会自动转换的，因此，当你想表达浮点数零的时候，一定要写成<code>0.0</code>而非<code>0</code>。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/24/Matter-js学习-1/" data-id="cjkj0cqoj000b8gv02c5gkylc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="introduction-Matter-js" class="article article-type-introduction" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/24/Matter-js/" class="article-date">
  <time datetime="2018-07-24T05:51:36.000Z" itemprop="datePublished">2018-07-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/24/Matter-js/">Matter.js</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/24/Matter-js/" data-id="cjkj0cqoo000f8gv00l5kvi3i" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-排序算法JS版本" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/21/排序算法JS版本/" class="article-date">
  <time datetime="2018-07-21T02:40:39.000Z" itemprop="datePublished">2018-07-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/21/排序算法JS版本/">排序算法JS版本</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>评价一个算法的好坏主要有以下几个特征</p>
<ol>
<li><p>稳定性：</p>
<p><strong>稳定</strong>：如果a原本在b前面，而a=b，排序之后a仍然在b的前面； </p>
<p><strong>不稳定</strong>：如果a原本在b的前面，而a=b，排序之后a可能会出现在b的后面；</p>
</li>
<li><p>复杂度</p>
<p><strong>时间复杂度</strong>：算法执行所耗费的时间</p>
<p><strong>空间复杂度</strong>：运行算法所需的内存的大小</p>
<p>详细见<a href="https://blog.csdn.net/booirror/article/details/7707551/" target="_blank" rel="noopener">https://blog.csdn.net/booirror/article/details/7707551/</a></p>
<p>排序算法还分内排序和外排序，内排序是所有操作都在内存上的排序，外排序指的是由于数据太大，因此把数据放在磁盘中，而排序通过磁盘和内存的数据传输才能进行</p>
</li>
</ol>
<h1 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h1><h2 id="算法描述"><a href="#算法描述" class="headerlink" title="算法描述"></a>算法描述</h2><p>1.相邻两个元素比较，小的到前面，大的到后面</p>
<p>2.从开始第一对到结尾的最后一对，这样确认最后的元素应该会是最大的数（冒泡）</p>
<p>3.重复冒泡，确认第二大的元素，第三大的元素。。。。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubbleSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len = arr.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; len - <span class="number">1</span> - i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[j] &gt; arr[j+<span class="number">1</span>]) &#123;        <span class="comment">//相邻元素两两对比</span></span><br><span class="line">                <span class="keyword">var</span> temp = arr[j+<span class="number">1</span>];        <span class="comment">//元素交换</span></span><br><span class="line">                arr[j+<span class="number">1</span>] = arr[j];</span><br><span class="line">                arr[j] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>改进冒泡排序：</strong> 设置一标志性变量pos,用于记录每趟排序中最后一次进行交换的位置。由于pos位置之后的记录均已交换到位,故在进行下一趟排序时只要扫描到pos位置即可。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubbleSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len = arr.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; len - <span class="number">1</span> - i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>]) &#123;        <span class="comment">//相邻元素两两对比</span></span><br><span class="line">                <span class="keyword">var</span> temp = arr[j + <span class="number">1</span>];        <span class="comment">//元素交换</span></span><br><span class="line">                arr[j + <span class="number">1</span>] = arr[j];</span><br><span class="line">                arr[j] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>平均情况：T(n) = O(n2)</p>
<p>#选择排序</p>
<p>表现最稳定的算法之一，无论什么数据进去都是O(n²)的时间复杂度。所以适合数据规模较小的排序</p>
<p>工作原理：首先在未排序序列中找到最小（大）元素，存放到排序序列的起始位置，然后，再从剩余未排序元素中继续寻找最小（大）元素，然后放到已排序序列的末尾。以此类推，直到所有元素均排序完毕。</p>
<p><1>.初始状态：无序区为R[1..n]，有序区为空；</1></p>
<p><2>.第i趟排序(i=1,2,3…n-1)开始时，当前有序区和无序区分别为R[1..i-1]和R(i..n）。该趟排序从当前无序区中-选出关键字最小的记录 R[k]，将它与无序区的第1个记录R交换，使R[1..i]和R[i+1..n)分别变为记录个数增加1个的新有序区和记录个数减少1个的新无序区；</2></p>
<p><3>.n-1趟结束，数组有序化了。</3></p>
<p>##算法分析</p>
<p>最佳情况：T(n) = O(n2)</p>
<p>最差情况：T(n) = O(n2)</p>
<p>平均情况：T(n) = O(n2)</p>
<p>#插入排序</p>
<p>通过构建有序序列，对于未排序数据，在已排序序列中从后向前扫描，找到相应位置并插入。插入排序在实现上，通常采用in-place排序（即只需用到O(1)的额外空间的排序），因而在从后向前扫描过程中，需要反复把已排序元素逐步向后挪位，为最新元素提供插入空间。</p>
<p><1>.从第一个元素开始，该元素可以认为已经被排序；</1></p>
<p><2>.取出下一个元素，在已经排序的元素序列中从后向前扫描；</2></p>
<p><3>.如果该元素（已排序）大于新元素，将该元素移到下一位置；</3></p>
<p><4>.重复步骤3，直到找到已排序的元素小于或者等于新元素的位置；</4></p>
<p><5>.将新元素插入到该位置后；</5></p>
<p><6>.重复步骤2~5。</6></p>
<p><strong>因为有已排序序列，所以在寻找未排序数据的位置的时候可以辅助使用二分查找法</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">binaryInsertionSort</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.toString.call(array).slice(<span class="number">8</span>, <span class="number">-1</span>) === <span class="string">'Array'</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.time(<span class="string">'二分插入排序耗时：'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> key = array[i], left = <span class="number">0</span>, right = i - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">                <span class="keyword">var</span> middle = <span class="built_in">parseInt</span>((left + right) / <span class="number">2</span>);</span><br><span class="line">                <span class="keyword">if</span> (key &lt; array[middle]) &#123;</span><br><span class="line">                    right = middle - <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    left = middle + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> j = i - <span class="number">1</span>; j &gt;= left; j--) &#123;</span><br><span class="line">                array[j + <span class="number">1</span>] = array[j];</span><br><span class="line">            &#125;</span><br><span class="line">            array[left] = key;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.timeEnd(<span class="string">'二分插入排序耗时：'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'array is not an Array!'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr=[<span class="number">3</span>,<span class="number">44</span>,<span class="number">38</span>,<span class="number">5</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">36</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">2</span>,<span class="number">46</span>,<span class="number">4</span>,<span class="number">19</span>,<span class="number">50</span>,<span class="number">48</span>];</span><br><span class="line"><span class="built_in">console</span>.log(binaryInsertionSort(arr));<span class="comment">//[2, 3, 4, 5, 15, 19, 26, 27, 36, 38, 44, 46, 47, 48, 50]</span></span><br></pre></td></tr></table></figure>
<h2 id="算法分析"><a href="#算法分析" class="headerlink" title="算法分析"></a>算法分析</h2><p>最佳情况：T(n) = O(n)</p>
<p>最差情况：T(n) = O(n2)</p>
<p>平均情况：T(n) = O(n2)</p>
<h1 id="希尔排序"><a href="#希尔排序" class="headerlink" title="希尔排序"></a>希尔排序</h1><p>先将整个待排序的记录序列分割成为若干子序列分别进行直接插入排序，具体算法描述：</p>
<p><1>. 选择一个增量序列t1，t2，…，tk，其中ti&gt;tj，tk=1；</1></p>
<p><2>.按增量序列个数k，对序列进行k 趟排序；</2></p>
<p><3>.每趟排序，根据对应的增量ti，将待排序列分割成若干长度为m 的子序列，分别对各子表进行直接插入排序。仅增量因子为1 时，整个序列作为一个表来处理，表长度即为整个序列的长度。</3></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shellSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len = arr.length,</span><br><span class="line">        temp,</span><br><span class="line">        gap = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">console</span>.time(<span class="string">'希尔排序耗时:'</span>);</span><br><span class="line">    <span class="keyword">while</span>(gap &lt; len/<span class="number">5</span>) &#123;          <span class="comment">//动态定义间隔序列</span></span><br><span class="line">        gap =gap*<span class="number">5</span>+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (gap; gap &gt; <span class="number">0</span>; gap = <span class="built_in">Math</span>.floor(gap/<span class="number">5</span>)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = gap; i &lt; len; i++) &#123;</span><br><span class="line">            temp = arr[i];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> j = i-gap; j &gt;= <span class="number">0</span> &amp;&amp; arr[j] &gt; temp; j-=gap) &#123;</span><br><span class="line">                arr[j+gap] = arr[j];</span><br><span class="line">            &#125;</span><br><span class="line">            arr[j+gap] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">'希尔排序耗时:'</span>);</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr=[<span class="number">3</span>,<span class="number">44</span>,<span class="number">38</span>,<span class="number">5</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">36</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">2</span>,<span class="number">46</span>,<span class="number">4</span>,<span class="number">19</span>,<span class="number">50</span>,<span class="number">48</span>];</span><br><span class="line"><span class="built_in">console</span>.log(shellSort(arr));<span class="comment">//[2, 3, 4, 5, 15, 19, 26, 27, 36, 38, 44, 46, 47, 48, 50]</span></span><br></pre></td></tr></table></figure>
<h4 id="算法分析-1"><a href="#算法分析-1" class="headerlink" title="算法分析"></a>算法分析</h4><p>最佳情况：T(n) = O(nlog2 n)</p>
<p>最坏情况：T(n) = O(nlog2 n)</p>
<p>平均情况：T(n) =O(nlog n)</p>
<h1 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h1><p>和选择排序一样，归并排序的性能不受输入数据的影响，但表现比选择排序好的多，因为始终都是O(n log n）的时间复杂度。代价是需要额外的内存空间。</p>
<p>归并排序是建立在归并操作上的一种有效的排序算法。该算法是采用分治法（Divide and Conquer）的一个非常典型的应用。归并排序是一种稳定的排序方法。将已有序的子序列合并，得到完全有序的序列；即先使每个子序列有序，再使子序列段间有序。若将两个有序表合并成一个有序表，称为2-路归并。</p>
<p><1>.把长度为n的输入序列分成两个长度为n/2的子序列；</1></p>
<p><2>.对这两个子序列分别采用归并排序；</2></p>
<p><3>.将两个排序好的子序列合并成一个最终的排序序列。</3></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// shift() 方法从数组中删除第一个元素，并返回该元素的值。此方法更改数组的长度。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeSort</span>(<span class="params">arr</span>) </span>&#123;  <span class="comment">//采用自上而下的递归方法</span></span><br><span class="line">    <span class="keyword">var</span> len = arr.length;</span><br><span class="line">    <span class="keyword">if</span>(len &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> arr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> middle = <span class="built_in">Math</span>.floor(len / <span class="number">2</span>),</span><br><span class="line">        left = arr.slice(<span class="number">0</span>, middle),</span><br><span class="line">        right = arr.slice(middle);</span><br><span class="line">    <span class="keyword">return</span> merge(mergeSort(left), mergeSort(right));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">merge</span>(<span class="params">left, right</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="built_in">console</span>.time(<span class="string">'归并排序耗时'</span>);</span><br><span class="line">    <span class="keyword">while</span> (left.length &amp;&amp; right.length) &#123;</span><br><span class="line">        <span class="keyword">if</span> (left[<span class="number">0</span>] &lt;= right[<span class="number">0</span>]) &#123;</span><br><span class="line">            result.push(left.shift());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result.push(right.shift());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (left.length)</span><br><span class="line">        result.push(left.shift());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (right.length)</span><br><span class="line">        result.push(right.shift());</span><br><span class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">'归并排序耗时'</span>);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr=[<span class="number">3</span>,<span class="number">44</span>,<span class="number">38</span>,<span class="number">5</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">36</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">2</span>,<span class="number">46</span>,<span class="number">4</span>,<span class="number">19</span>,<span class="number">50</span>,<span class="number">48</span>];</span><br><span class="line"><span class="built_in">console</span>.log(mergeSort(arr));</span><br></pre></td></tr></table></figure>
<p>##算法分析</p>
<ul>
<li>最佳情况：T(n) = O(n)</li>
<li>最差情况：T(n) = O(nlogn)</li>
<li>平均情况：T(n) = O(nlogn)</li>
</ul>
<h1 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h1><p>处理大数据最快的排序算法之一</p>
<p>基本思想：通过一趟排序将待排记录分隔成独立的两部分，其中一部分记录的关键字均比另一部分的关键字小，则可分别对这两部分记录继续进行排序，以达到整个序列有序。</p>
<p><1>.从数列中挑出一个元素，称为 “基准”（pivot）；</1></p>
<p><2>.重新排序数列，所有元素比基准值小的摆放在基准前面，所有元素比基准值大的摆在基准的后面（相同的数可以到任一边）。在这个分区退出之后，该基准就处于数列的中间位置。这个称为分区（partition）操作；</2></p>
<p><3>.递归地（recursive）把小于基准值元素的子数列和大于基准值元素的子数列排序。</3></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/21/排序算法JS版本/" data-id="cjkj0cqq2001f8gv0pibnmq5g" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/算法/">算法</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-游戏开发协议-Protobuf" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/20/游戏开发协议-Protobuf/" class="article-date">
  <time datetime="2018-07-20T05:51:20.000Z" itemprop="datePublished">2018-07-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/20/游戏开发协议-Protobuf/">游戏开发协议-Protobuf</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>Protocol Buffers就是一种google定义的结构化数据格式，用于数据的序列化和反序列化。由于它直接对二进制源数据进行操作，所以它相对于xml来说，足够的小，快以及简单，而且又与语言、平台无关，所以兼容性也有不错的表现。目前很适合做数据存储或 网络通讯间的数据传输。</p>
<h1 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h1><ol start="0">
<li><p>首先需要激活protoc命令，使用brew install protobuf安装</p>
</li>
<li><p>定义.proto文件“login.proto”</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">syntax = &quot;proto3&quot;;</span><br><span class="line"></span><br><span class="line">package msg;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">option java_package = &quot;com.example.msg&quot;;</span><br><span class="line"></span><br><span class="line">option java_outer_classname = &quot;LoginMsg&quot;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">message Login&#123;</span><br><span class="line"></span><br><span class="line">    string username = 1;</span><br><span class="line"></span><br><span class="line">    int32 pw = 2;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编译<code>protoc -I=. --java_out=.  login.proto</code></p>
<p>生成了LoginMsg.java</p>
</li>
<li><p>对LoginMsg进行操作</p>
<p>通过.proto定义生成的LoginMsg.java，已经整合了对LoginMsg的序列化和反序列化相关代码，我们对login这个消息的reader和writer时只需要通过对该class进行操作即可。比如要把loginMsg写入到流里面发送出去，只需要对loginMsg进行赋值然后writer，对象就被序列化为二进制数据写出，或者接收端读取LoginMsg时，调用其ParserbyReader,就可以基于二进制流反序列化为LoginMsg对象。</p>
<p>write：</p>
<img src="/2018/07/20/游戏开发协议-Protobuf/write01.png" title="This is an example image">
<p>read：</p>
<img src="/2018/07/20/游戏开发协议-Protobuf/read01.png" title="This is an example image">
<p>只需要对上述的stream改造为为socket就可以基于tcp进行消息传输了。</p>
<h2 id="LoginMsg内容"><a href="#LoginMsg内容" class="headerlink" title="LoginMsg内容"></a>LoginMsg内容</h2><h2 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h2><p>消息结构对象的主体，主要存储数据，同时继承GeneratedMessageV3，内部封装对象的序列化和反序列化，writeTo序列化，paser反序列化。</p>
<h2 id="LoginOrBuilder"><a href="#LoginOrBuilder" class="headerlink" title="LoginOrBuilder"></a>LoginOrBuilder</h2><p>接口，用来连接Login和Builder，提供类型信息以及对外提供field get方法。</p>
<h2 id="Builder"><a href="#Builder" class="headerlink" title="Builder"></a>Builder</h2><p>消息对象构建器，对外封装field set方法。</p>
<h2 id="Descriptor"><a href="#Descriptor" class="headerlink" title="Descriptor"></a>Descriptor</h2><p>消息对象元数据的描述信息，一般用不到，如果你有动态解析的需求可以通过此来处理</p>
<h2 id="Parser"><a href="#Parser" class="headerlink" title="Parser"></a>Parser</h2><p>解析器，为消息反序列化提供服务</p>
</li>
</ol>
<p>结构关系如下:</p>
<img src="/2018/07/20/游戏开发协议-Protobuf/protobuf01.png" title="This is an example image">
<p>MessageLite/Message接口是所有message的抽象接口，message可以基于Parser从字节流数据中构建对象，也可以通过Builder创建的对象序列化后写入字节流数据到IO管道，MessageLite和Message内部都定义了自己的Builder类，继承自MessageLiteOrBuilder以及MessageOrBuiler，并定义了MessageLite/Message和它们各自Builder类的共同接口。</p>
<h2 id="调用时序"><a href="#调用时序" class="headerlink" title="调用时序"></a>调用时序</h2><p>。。。</p>
<p>内容搬运<a href="https://www.jianshu.com/p/9cb9fb05431a" target="_blank" rel="noopener">https://www.jianshu.com/p/9cb9fb05431a</a></p>
<p><a href="https://www.jianshu.com/p/ec39f79c0412" target="_blank" rel="noopener">https://www.jianshu.com/p/ec39f79c0412</a></p>
<h1 id="JavaScript版本"><a href="#JavaScript版本" class="headerlink" title="JavaScript版本"></a>JavaScript版本</h1><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">syntax = &quot;proto3&quot;;</span><br><span class="line">message Login&#123;</span><br><span class="line"></span><br><span class="line">    string username = 1;</span><br><span class="line"></span><br><span class="line">    int32 pw = 2;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行<code>protoc -I=. --js_out=.  login.proto</code>即可以产生js版本的代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @fileoverview</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @enhanceable</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @suppress &#123;messageConventions&#125; JS Compiler reports an error if a variable or</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \*     field starts with 'MSG_' and isn't a translatable message.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @public</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// GENERATED CODE -- DO NOT EDIT!</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">goog.provide(<span class="string">'proto.Login'</span>);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">goog.require(<span class="string">'jspb.BinaryReader'</span>);</span><br><span class="line"></span><br><span class="line">goog.require(<span class="string">'jspb.BinaryWriter'</span>);</span><br><span class="line"></span><br><span class="line">goog.require(<span class="string">'jspb.Message'</span>);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* Generated by JsPbCodeGenerator.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @param &#123;Array=&#125; opt_data Optional initial data array, typically from a</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* server response, or constructed directly in Javascript. The array is used</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* in place and becomes part of the constructed object. It is not cloned.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* If no data is provided, the constructed object will be empty, but still</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* valid.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @extends &#123;jspb.Message&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @constructor</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">proto.Login = <span class="function"><span class="keyword">function</span>(<span class="params">opt_data</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  jspb.Message.initialize(<span class="keyword">this</span>, opt_data, <span class="number">0</span>, <span class="number">-1</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">goog.inherits(proto.Login, jspb.Message);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (goog.DEBUG &amp;&amp; !COMPILED) &#123;</span><br><span class="line"></span><br><span class="line">  proto.Login.displayName = <span class="string">'proto.Login'</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (jspb.Message.GENERATE_TO_OBJECT) &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* Creates an object representation of this proto suitable for use in Soy templates.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* Field names that are reserved in JavaScript and will be renamed to pb_name.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* To access a reserved field use, foo.pb_&lt;name&gt;, eg, foo.pb_default.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* For the list of reserved names please see:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \*     com.google.apps.jspb.JsClassTemplate.JS_RESERVED_WORDS.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @param &#123;boolean=&#125; opt_includeInstance Whether to include the JSPB instance</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \*     for transitional soy proto support: http://goto/soy-param-migration</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @return &#123;!Object&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">proto.Login.prototype.toObject = <span class="function"><span class="keyword">function</span>(<span class="params">opt_includeInstance</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> proto.Login.toObject(opt_includeInstance, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* Static version of the &#123;@see toObject&#125; method.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @param &#123;boolean|undefined&#125; includeInstance Whether to include the JSPB</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \*     instance for transitional soy proto support:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \*     http://goto/soy-param-migration</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @param &#123;!proto.Login&#125; msg The msg instance to transform.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @return &#123;!Object&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @suppress &#123;unusedLocalVariables&#125; f is only used for nested messages</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">proto.Login.toObject = <span class="function"><span class="keyword">function</span>(<span class="params">includeInstance, msg</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> f, obj = &#123;</span><br><span class="line"></span><br><span class="line">    username: jspb.Message.getFieldWithDefault(msg, <span class="number">1</span>, <span class="string">""</span>),</span><br><span class="line"></span><br><span class="line">    pw: jspb.Message.getFieldWithDefault(msg, <span class="number">2</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (includeInstance) &#123;</span><br><span class="line"></span><br><span class="line">    obj.$jspbMessageInstance = msg;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* Deserializes binary data (in protobuf wire format).</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @param &#123;jspb.ByteSource&#125; bytes The bytes to deserialize.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @return &#123;!proto.Login&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">proto.Login.deserializeBinary = <span class="function"><span class="keyword">function</span>(<span class="params">bytes</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> reader = <span class="keyword">new</span> jspb.BinaryReader(bytes);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> msg = <span class="keyword">new</span> proto.Login;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> proto.Login.deserializeBinaryFromReader(msg, reader);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* Deserializes binary data (in protobuf wire format) from the</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* given reader into the given message object.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @param &#123;!proto.Login&#125; msg The message object to deserialize into.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @param &#123;!jspb.BinaryReader&#125; reader The BinaryReader to use.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @return &#123;!proto.Login&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">proto.Login.deserializeBinaryFromReader = <span class="function"><span class="keyword">function</span>(<span class="params">msg, reader</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (reader.nextField()) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (reader.isEndGroup()) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> field = reader.getFieldNumber();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (field) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> value = <span class="comment">/** @type &#123;string&#125; */</span> (reader.readString());</span><br><span class="line"></span><br><span class="line">      msg.setUsername(value);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> value = <span class="comment">/** @type &#123;number&#125; */</span> (reader.readInt32());</span><br><span class="line"></span><br><span class="line">      msg.setPw(value);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line"></span><br><span class="line">      reader.skipField();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> msg;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* Serializes the message to binary data (in protobuf wire format).</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @return &#123;!Uint8Array&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">proto.Login.prototype.serializeBinary = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> writer = <span class="keyword">new</span> jspb.BinaryWriter();</span><br><span class="line"></span><br><span class="line">  proto.Login.serializeBinaryToWriter(<span class="keyword">this</span>, writer);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> writer.getResultBuffer();</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* Serializes the given message to binary data (in protobuf wire</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* format), writing to the given BinaryWriter.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @param &#123;!proto.Login&#125; message</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @param &#123;!jspb.BinaryWriter&#125; writer</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @suppress &#123;unusedLocalVariables&#125; f is only used for nested messages</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">proto.Login.serializeBinaryToWriter = <span class="function"><span class="keyword">function</span>(<span class="params">message, writer</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> f = <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">  f = message.getUsername();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (f.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">    writer.writeString(</span><br><span class="line"></span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line"></span><br><span class="line">      f</span><br><span class="line"></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  f = message.getPw();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (f !== <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">    writer.writeInt32(</span><br><span class="line"></span><br><span class="line">      <span class="number">2</span>,</span><br><span class="line"></span><br><span class="line">      f</span><br><span class="line"></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* optional string username = 1;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @return &#123;string&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">proto.Login.prototype.getUsername = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="comment">/** @type &#123;string&#125; */</span> (jspb.Message.getFieldWithDefault(<span class="keyword">this</span>, <span class="number">1</span>, <span class="string">""</span>));</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">/** @param &#123;string&#125; value */</span></span><br><span class="line"></span><br><span class="line">proto.Login.prototype.setUsername = <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  jspb.Message.setProto3StringField(<span class="keyword">this</span>, <span class="number">1</span>, value);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* optional int32 pw = 2;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> \* @return &#123;number&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">proto.Login.prototype.getPw = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="comment">/** @type &#123;number&#125; */</span> (jspb.Message.getFieldWithDefault(<span class="keyword">this</span>, <span class="number">2</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">/** @param &#123;number&#125; value */</span></span><br><span class="line"></span><br><span class="line">proto.Login.prototype.setPw = <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  jspb.Message.setProto3IntField(<span class="keyword">this</span>, <span class="number">2</span>, value);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p> 代码结构要简单的多，主要调用的是jspb库。</p>
<p>很容易看出来，fieldNumber很重要，所以在前后端更新协议的时候，往后面加，而不是在中间插</p>
<h2 id="message的二进制结构"><a href="#message的二进制结构" class="headerlink" title="message的二进制结构"></a>message的二进制结构</h2><img src="/2018/07/20/游戏开发协议-Protobuf/message01.png" title="This is an example image">
<p>每个消息字段读取的时候，都会先调用一次readTag或者writeTag。tag等于就是这个value信息的描述或者定义，告知解析器当前fields是什么类型字段，以及读取的顺序，有了这个信息，解析器就知道一个field在流中的开始位置和结束位置，如此一个field解码成功，并且与字段顺序无关。</p>
<h3 id="tag的构成"><a href="#tag的构成" class="headerlink" title="tag的构成"></a>tag的构成</h3><p><code>(fieldNumber &lt;&lt; 3) | wireType</code></p>
<h1 id="Protobuf的优点"><a href="#Protobuf的优点" class="headerlink" title="Protobuf的优点"></a>Protobuf的优点</h1><p>fieldNumber 为每个field定义一个编号，其一保证不重复，其二保证其在流中的位置。如若当前数据流中有某个字段，而解析方没有相关的解析代码，解析放会直接skip 这个field，而且读数据的position也会后移，保证后续读取不出问题。</p>
<h1 id="cautions"><a href="#cautions" class="headerlink" title="cautions"></a>cautions</h1><p>proto文件要使用UTF-8</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/20/游戏开发协议-Protobuf/" data-id="cjkj0cqq4001g8gv0jsn7ju3u" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cocos2dx-JS/">Cocos2dx-JS</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cocos-JavaScript/">Cocos JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cocos2d-x/">Cocos2d-x</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cocos2d-x-OpenGL/">Cocos2d-x OpenGL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cocos2d-x-优化/">Cocos2d-x 优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cocos2dx-JS/">Cocos2dx-JS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript-JavaScript忍者秘籍/">JavaScript JavaScript忍者秘籍</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/codefights/">codefights</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/程序员面试金典/">程序员面试金典</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络/">网络</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Cocos-JavaScript/" style="font-size: 10px;">Cocos JavaScript</a> <a href="/tags/Cocos2d-x/" style="font-size: 10px;">Cocos2d-x</a> <a href="/tags/Cocos2d-x-OpenGL/" style="font-size: 15px;">Cocos2d-x OpenGL</a> <a href="/tags/Cocos2d-x-优化/" style="font-size: 10px;">Cocos2d-x 优化</a> <a href="/tags/Cocos2dx-JS/" style="font-size: 10px;">Cocos2dx-JS</a> <a href="/tags/JavaScript/" style="font-size: 20px;">JavaScript</a> <a href="/tags/JavaScript-JavaScript忍者秘籍/" style="font-size: 10px;">JavaScript JavaScript忍者秘籍</a> <a href="/tags/codefights/" style="font-size: 10px;">codefights</a> <a href="/tags/程序员面试金典/" style="font-size: 10px;">程序员面试金典</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a> <a href="/tags/网络/" style="font-size: 20px;">网络</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/08/06/ES-1/">ES-1</a>
          </li>
        
          <li>
            <a href="/2018/07/31/Cocos2d-x精灵/">Cocos2d-x精灵</a>
          </li>
        
          <li>
            <a href="/2018/07/30/Cocos2d-x纹理/">Cocos2d-x纹理</a>
          </li>
        
          <li>
            <a href="/2018/07/28/Cocos2d-x的优化/">Cocos2d-x的优化</a>
          </li>
        
          <li>
            <a href="/2018/07/27/网络-TCP/">网络-TCP</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 kjlist<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>